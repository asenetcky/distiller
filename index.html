<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Distill EPHT Data Down to XML • distiller</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Distill EPHT Data Down to XML">
<meta name="description" content="Centers for Disease Control and Preventions (CDC) Environmental Public Health Tracking Network (EPHT) data submission process has a lot documentation. Much of it is buried and out of date, making it difficult for new users to decipher the exact specifications of the data submissions XML. `distiller` aims to make it easier to created the desired XML.">
<meta property="og:description" content="Centers for Disease Control and Preventions (CDC) Environmental Public Health Tracking Network (EPHT) data submission process has a lot documentation. Much of it is buried and out of date, making it difficult for new users to decipher the exact specifications of the data submissions XML. `distiller` aims to make it easier to created the desired XML.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">distiller</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/asenetcky/distiller/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="distiller">distiller<a class="anchor" aria-label="anchor" href="#distiller"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>As a newbie who has to submit data to the CDC’s EPHT program, I was dismayed to find out that the documentation is buried under many layers inside their SharePoint. It is also highly fragmented, convoluted and in many cases, conflicts with itself.</p>
<p>My goal is to make this process easier and reproducible for myself, and others.</p>
<p>So who is this highly specific package for?</p>
<ul>
<li>Do you submit data to the CDC’s EPHT program?</li>
<li>Do you use R? Or are interested in incorporating R into your workflow?</li>
<li>Do you struggle with the CDC’s EPHT documenation and/or tooling?</li>
<li>Do you want to make your submission process more reproducible?</li>
</ul>
<p>If you answered yes to the first question and any of the others, then this package might be for you.</p>
</div>
<div class="section level2">
<h2 id="what-does-this-package-do">What does this package do?<a class="anchor" aria-label="anchor" href="#what-does-this-package-do"></a>
</h2>
<p>I think it’s important to state up front what this package <em>doesn’t</em> do - and that is, it will not wrangle your data for you. There are a few helpers, and and a whole slew of checks <code>distiller</code> will run on your data and metadata to ensure that everything is reasonably close to the correct format for submission to the CDC’s EPHT program.</p>
<p><code>distiller</code> still expects your data to have specific variable names, and to have the required variables for each type of data. However, if you’ve ever wondered why the epht requires different <em>variable names</em> in a <em>different order</em> for the same types of data, even for the <em>same disease</em> you’ll be pleased to know that distiller takes care of the facility-type-specific naming conventions and the ordering for you. Users just need to bring the data and now they can spend less time worrying about XML semantics and more time polishing their data products.</p>
<p><code>disitller</code> is <strong>no</strong> replacement for the CDC EPHPT Test Submission portal, however, creating the XML, and shuffling files around and then dropping them into the portal and waiting an indeterminate amount of time for feedback eats up time and is a pain. <code>distiller</code> aims to provide feedback on your data and metadata before you send it off to the CDC. This way, you can fix any obvious issues before you sink 20+ minutes waiting to find out you forgot to replace your <code>NA</code>’s with “U”.</p>
</div>
<div class="section level2">
<h2 id="whats-in-the-box">What’s in the box?<a class="anchor" aria-label="anchor" href="#whats-in-the-box"></a>
</h2>
<p><code>distiller</code> contains the following core functions:</p>
<ul>
<li>
<code><a href="reference/check_submission.html">check_submission()</a></code> - a function that checks your data and metadata and provides quick feedback</li>
<li>
<code><a href="reference/make_xml_document.html">make_xml_document()</a></code> - a function that creates an xml document for submission based on your data and the metadata your provide it</li>
</ul>
<p><code>distiller</code> also contains functions for:</p>
<ul>
<li>collapsing race and ethnicity values into the CDC’s required format</li>
<li>converting month integers to 0-padded character strings</li>
<li>return the proper health outcome identifier for a given content group identifier</li>
<li>Starting from scratch? Most of the mini-functions that make up the two core ones are exposed to the user, so you can check your work in pieces as you make progress with your data wrangling</li>
</ul>
</div>
<div class="section level2">
<h2 id="distiller-expectations-and-scope">
<code>distiller</code> expectations and scope<a class="anchor" aria-label="anchor" href="#distiller-expectations-and-scope"></a>
</h2>
<p><code>distiller</code> works for the following content group identifiers:</p>
<ul>
<li>AS-HOSP</li>
<li>AS-ED</li>
<li>CO-HOSP</li>
<li>CO-ED</li>
<li>MI-HOSP</li>
<li>HEAT-HOSP</li>
<li>HEAT-ED</li>
<li>COPD-HOSP</li>
<li>COPD-ED</li>
</ul>
<p><code>distiller</code> expects the following variables in your data:</p>
<p>For every content group identifier:</p>
<ul>
<li>agegroup</li>
<li>county</li>
<li>sex</li>
<li>ethnicity</li>
<li>race</li>
<li>health_outcome_id,</li>
<li>monthly_count</li>
<li>month</li>
<li>year</li>
</ul>
<p>For content group identifiers CO-HOSP and CO-ED, the above plus the following:</p>
<ul>
<li>fire_count</li>
<li>nonfire_count</li>
<li>unknown_count</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of distiller from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"asenetcky/distiller"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Here is a basic example of how to use it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/asenetcky/distiller" class="external-link">distiller</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Take you already-wrangled data</span></span>
<span><span class="co"># note the specific variable names</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>      month <span class="op">=</span> <span class="va">mpg</span>,</span>
<span>      agegroup <span class="op">=</span> <span class="va">cyl</span>,</span>
<span>      county <span class="op">=</span> <span class="va">disp</span>,</span>
<span>      ethnicity <span class="op">=</span> <span class="va">hp</span>,</span>
<span>      health_outcome_id <span class="op">=</span> <span class="va">drat</span>,</span>
<span>      monthly_count <span class="op">=</span> <span class="va">wt</span>,</span>
<span>      race <span class="op">=</span> <span class="va">qsec</span>,</span>
<span>      sex <span class="op">=</span> <span class="va">vs</span>,</span>
<span>      year <span class="op">=</span> <span class="va">am</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gear</span>, <span class="va">carb</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And your metadata</span></span>
<span>  <span class="va">content_group_id</span> <span class="op">&lt;-</span> <span class="st">"AS-HOSP"</span></span>
<span>  <span class="va">mcn</span> <span class="op">&lt;-</span> <span class="st">"1234-1234-1234-1234-1234"</span></span>
<span>  <span class="va">jurisdiction_code</span> <span class="op">&lt;-</span> <span class="st">"two_letter_code"</span></span>
<span>  <span class="va">state_fips_code</span> <span class="op">&lt;-</span> <span class="st">"1234"</span></span>
<span>  <span class="va">submitter_email</span> <span class="op">&lt;-</span> <span class="st">"submitter@email.com"</span></span>
<span>  <span class="va">submitter_name</span> <span class="op">&lt;-</span> <span class="st">"Submitter Name"</span></span>
<span>  <span class="va">submitter_title</span> <span class="op">&lt;-</span> <span class="st">"Submitter Title"</span></span>
<span>  </span>
<span><span class="co"># Optionally check your submission data structure and metadata</span></span>
<span>  <span class="fu"><a href="reference/check_submission.html">check_submission</a></span><span class="op">(</span></span>
<span>    <span class="va">data</span>,</span>
<span>    <span class="va">content_group_id</span>,</span>
<span>    <span class="va">mcn</span>,</span>
<span>    <span class="va">jurisdiction_code</span>,</span>
<span>    <span class="va">state_fips_code</span>,</span>
<span>    <span class="va">submitter_email</span>,</span>
<span>    <span class="va">submitter_name</span>,</span>
<span>    <span class="va">submitter_title</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Checking submission metadata</span></span>
<span><span class="co">#&gt; ✔ Success: content_group_id</span></span>
<span><span class="co">#&gt; ! Warning: mcn may not have correct format</span></span>
<span><span class="co">#&gt; Troublemakers: length, format</span></span>
<span><span class="co">#&gt; ! Warning: jurisdiction_code may not have correct format</span></span>
<span><span class="co">#&gt; Troublemakers: length, format</span></span>
<span><span class="co">#&gt; ! Warning: state_fips_code may not have correct format</span></span>
<span><span class="co">#&gt; Troublemakers: length, format</span></span>
<span><span class="co">#&gt; ✔ Success: submitter_email</span></span>
<span><span class="co">#&gt; ✔ Success: submitter_name</span></span>
<span><span class="co">#&gt; ✔ Success: submitter_title</span></span>
<span><span class="co">#&gt; ℹ Checking data structure and content</span></span>
<span><span class="co">#&gt; ✔ Success: dataframe_structure</span></span>
<span><span class="co">#&gt; ✖ Danger: month does not have allowable value/s</span></span>
<span><span class="co">#&gt; Troublemakers: allowed_values</span></span>
<span><span class="co">#&gt; ✔ Success: agegroup</span></span>
<span><span class="co">#&gt; ✖ Danger: county does not have allowable value/s</span></span>
<span><span class="co">#&gt; Troublemakers: length</span></span>
<span><span class="co">#&gt; ✖ Danger: ethnicity does not have allowable value/s</span></span>
<span><span class="co">#&gt; Troublemakers: allowed_values</span></span>
<span><span class="co">#&gt; ✖ Danger: health_outcome_id does not have allowable value/s</span></span>
<span><span class="co">#&gt; Troublemakers: allowed_values</span></span>
<span><span class="co">#&gt; ✖ Danger: sex does not have allowable value/s</span></span>
<span><span class="co">#&gt; Troublemakers: allowed_values</span></span>
<span><span class="co">#&gt; ✖ Danger: year does not have allowable value/s</span></span>
<span><span class="co">#&gt; Troublemakers: allowed_values</span></span>
<span><span class="co">#&gt; ✖ Danger: race does not have allowable value/s</span></span>
<span><span class="co">#&gt; Troublemakers: allowed_values</span></span>
<span><span class="co">#&gt; ✔ Success: monthly_count</span></span>
<span><span class="co"># This can also be checked with `check_first = TRUE` in `make_xml_document()`</span></span>
<span>  </span>
<span></span>
<span><span class="co"># And then make your xml document</span></span>
<span><span class="fu"><a href="reference/make_xml_document.html">make_xml_document</a></span><span class="op">(</span></span>
<span>    <span class="va">data</span>,</span>
<span>    <span class="va">content_group_id</span>,</span>
<span>    <span class="va">mcn</span>,</span>
<span>    <span class="va">jurisdiction_code</span>,</span>
<span>    <span class="va">state_fips_code</span>,</span>
<span>    <span class="va">submitter_email</span>,</span>
<span>    <span class="va">submitter_name</span>,</span>
<span>    <span class="va">submitter_title</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; {xml_document}</span></span>
<span><span class="co">#&gt; &lt;HospitalizationData schemaLocation="http://www.ephtn.org/NCDM/PH/HospitalizationData ephtn-ph-HospitalizationData.xsd" xmlns="http://www.ephtn.org/NCDM/PH/HospitalizationData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;Header&gt;\n  &lt;MCN&gt;1234-1234-1234-1234-1234&lt;/MCN&gt;\n  &lt;JurisdictionCode&gt;two_ ...</span></span>
<span><span class="co">#&gt; [2] &lt;Dataset&gt;\n  &lt;Row&gt;\n    &lt;RowIdentifier&gt;1&lt;/RowIdentifier&gt;\n    &lt;AdmissionM ...</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/asenetcky/distiller/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/asenetcky/distiller/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing distiller</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alexander Senetcky <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0009-0009-3730-5397" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/asenetcky/distiller/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/asenetcky/distiller/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/asenetcky/distiller" class="external-link"><img src="https://codecov.io/gh/asenetcky/distiller/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Senetcky.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
